# フォトブック管理アプリケーション - Web版

デスクトップ版と同じ機能をブラウザ上で利用できるWeb版です。

## 特徴

- ✅ **すべての機能を実装**: デスクトップ版と同じ機能（リネーム、Undo、JSON出力）
- ✅ **既存コードを再利用**: services/ のロジックをそのまま使用
- ✅ **モダンなUI**: レスポンシブデザインで使いやすい
- ✅ **簡単起動**: ダブルクリックでサーバー起動

## 動作環境

- Python 3.10以上
- モダンなWebブラウザ（Chrome, Firefox, Safari, Edge）

## インストール

### 1. 依存関係のインストール

```bash
pip install -r web/requirements-web.txt
```

または、起動スクリプトが自動的にインストールします。

### 2. 起動方法

#### Windows

`start_web.bat` をダブルクリック

または、コマンドプロンプトから:
```bash
start_web.bat
```

#### Mac / Linux

ターミナルから:
```bash
./start_web.sh
```

または:
```bash
cd web
python3 server.py
```

### 3. アクセス

ブラウザが自動的に開きます。手動で開く場合は以下のURLにアクセス:

```
http://127.0.0.1:5000
```

## 使い方

### 基本的な操作フロー

1. **「フォルダを開く」ボタンをクリック**
   - モーダルでドライブ/ディレクトリを選択
   - サブフォルダを辿って目的のフォルダを選択

2. **画像を選択**
   - サムネイルをクリック（Ctrl+クリックで複数選択）
   - 「選択をバスケットに追加」ボタンをクリック

3. **ラベルを適用**
   - キーボードの数字キー（1-9）でラベルを適用
   - または右ペインのプリセットから選択

4. **順序調整**
   - バスケット内でアイテムを選択
   - 「▲ 上へ」「▼ 下へ」ボタンで並べ替え

5. **プレビュー**
   - テンプレートを設定（例: `V-{seq:1}_{label}`）
   - 「プレビュー」ボタンでリネーム結果を確認

6. **実行**
   - 「実行」ボタンでリネームを実行
   - 成功すると画像リストが自動的に更新されます

7. **JSON出力**
   - 「JSON出力」ボタンで画像情報をエクスポート
   - 自動的にJSONファイルがダウンロードされます

### キーボードショートカット

- **1-9キー**: 対応するラベルを適用（バスケット内の選択を優先）
- **Delete**: サムネイルグリッドの選択をクリア
- **Ctrl+クリック**: 複数選択

## プロジェクト構造

```
web/
├── server.py              # Flaskサーバー
├── requirements-web.txt   # Web版の依存関係
├── README.md              # このファイル
└── static/
    ├── index.html         # メインHTML
    ├── css/
    │   └── style.css      # スタイルシート
    └── js/
        └── app.js         # JavaScriptアプリケーション
```

## 技術スタック

### バックエンド
- **Flask**: 軽量Webフレームワーク
- **Flask-CORS**: クロスオリジンリクエスト対応
- **既存のservicesモジュール**: デスクトップ版のロジックを再利用

### フロントエンド
- **HTML5 + CSS3**: モダンなUI
- **Vanilla JavaScript**: フレームワーク不要のシンプルな実装
- **Fetch API**: サーバーとの通信

## 主な機能

### 実装済み機能

✅ フォルダ参照（クロスプラットフォーム対応）
✅ サムネイル表示（非同期読み込み）
✅ 画像のソート（撮影日時、ファイル名）
✅ 複数選択（Ctrl+クリック）
✅ 選択バスケット
✅ ドラッグ&ドロップ風の並べ替え（▲▼ボタン）
✅ ラベル付け（キーボードショートカット対応）
✅ リネームプレビュー
✅ リネーム実行
✅ Undo機能
✅ JSON出力
✅ ログ表示

## トラブルシューティング

### サーバーが起動しない

- Pythonがインストールされているか確認
- 依存関係がインストールされているか確認:
  ```bash
  pip install -r web/requirements-web.txt
  ```

### ブラウザが自動的に開かない

- 手動で以下のURLを開いてください:
  ```
  http://127.0.0.1:5000
  ```

### フォルダが選択できない

- フォルダへのアクセス権限を確認してください
- 別のドライブ/ディレクトリから試してみてください

### サムネイルが表示されない

- 画像形式が対応しているか確認（JPG, PNG, HEIC, GIF, BMP）
- HEIC形式の場合は `requirements-heic.txt` をインストール:
  ```bash
  pip install -r requirements-heic.txt
  ```

### リネームが失敗する

- ファイルが他のアプリケーションで開かれていないか確認
- 書き込み権限があるか確認

## デスクトップ版との違い

| 項目 | デスクトップ版 | Web版 |
|------|---------------|-------|
| 起動方法 | `python main.py` | `start_web.bat` or `start_web.sh` |
| UI | PySide6 (Qt) | HTML + CSS + JavaScript |
| フォルダ選択 | ネイティブダイアログ | カスタムモーダル |
| サムネイル | QPixmap | Base64エンコード画像 |
| 並べ替え | ドラッグ&ドロップ | ▲▼ボタン |

**機能は完全に同じです！**

## セキュリティ

- **ローカルのみ**: サーバーは `127.0.0.1` でのみリッスン
- **インターネット接続不要**: 完全にローカルで動作
- **ファイルは外部送信されません**: すべての処理はローカルマシン内で完結

## ライセンス

このプロジェクトは内部利用を想定しています。

---

**作成日**: 2025-11-14
**バージョン**: 1.0 (Web版)
